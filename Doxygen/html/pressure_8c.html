<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Group #3: Sensor Testing and Demonstration Device -- Pressure System: Src/pressure.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Group #3: Sensor Testing and Demonstration Device -- Pressure System<span id="projectnumber">&#160;0.01</span>
   </div>
   <div id="projectbrief">Pressure computer subsystem</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">pressure.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="structPressure.html">Pressure</a> system main program body.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pressure_8h_source.html">pressure.h</a>&quot;</code><br />
<code>#include &quot;I2C_LCD.h&quot;</code><br />
<code>#include &quot;<a class="el" href="menu_8h_source.html">menu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rotary_8h_source.html">rotary.h</a>&quot;</code><br />
<code>#include &quot;stm32f4xx_hal.h&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adda669c0c808f211208dfa3d3551c094" id="r_adda669c0c808f211208dfa3d3551c094"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adda669c0c808f211208dfa3d3551c094">pressure_init</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure)</td></tr>
<tr class="memdesc:adda669c0c808f211208dfa3d3551c094"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes components for the pressure system.  <br /></td></tr>
<tr class="separator:adda669c0c808f211208dfa3d3551c094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af557db21f677bfcc5c63fa8689be6db9" id="r_af557db21f677bfcc5c63fa8689be6db9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af557db21f677bfcc5c63fa8689be6db9">pressure_cleanup</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure)</td></tr>
<tr class="memdesc:af557db21f677bfcc5c63fa8689be6db9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deinitializes components for the pressure system.  <br /></td></tr>
<tr class="separator:af557db21f677bfcc5c63fa8689be6db9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a945eb3fcaf46267415c8d3452eb5904f" id="r_a945eb3fcaf46267415c8d3452eb5904f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a945eb3fcaf46267415c8d3452eb5904f">pressure_uart_tx</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure)</td></tr>
<tr class="memdesc:a945eb3fcaf46267415c8d3452eb5904f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmits the current pressure read by the sensor out through UART.  <br /></td></tr>
<tr class="separator:a945eb3fcaf46267415c8d3452eb5904f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47565a90a90de1e680ec70255cc7bfd0" id="r_a47565a90a90de1e680ec70255cc7bfd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a47565a90a90de1e680ec70255cc7bfd0">pressure_sensor_read</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure)</td></tr>
<tr class="memdesc:a47565a90a90de1e680ec70255cc7bfd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads in the current pressure from the sensor using the ADC.  <br /></td></tr>
<tr class="separator:a47565a90a90de1e680ec70255cc7bfd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec131e0e34a56c67505246c8124dfe3c" id="r_aec131e0e34a56c67505246c8124dfe3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec131e0e34a56c67505246c8124dfe3c">pressure_ramp_v3</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure, uint8_t dev, float target, float perr)</td></tr>
<tr class="memdesc:aec131e0e34a56c67505246c8124dfe3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ramps system to a target pressure with error bounds.  <br /></td></tr>
<tr class="separator:aec131e0e34a56c67505246c8124dfe3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3de0ebd076031525e341166e7845a37a" id="r_a3de0ebd076031525e341166e7845a37a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3de0ebd076031525e341166e7845a37a">pressure_calib_static</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure)</td></tr>
<tr class="memdesc:a3de0ebd076031525e341166e7845a37a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that performs static calibration.  <br /></td></tr>
<tr class="separator:a3de0ebd076031525e341166e7845a37a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba52b6fe1b4fcb0e1128079ec6d203c6" id="r_aba52b6fe1b4fcb0e1128079ec6d203c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba52b6fe1b4fcb0e1128079ec6d203c6">pressure_calib_dynam_step</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure)</td></tr>
<tr class="memdesc:aba52b6fe1b4fcb0e1128079ec6d203c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that performs dynamic step calibration.  <br /></td></tr>
<tr class="separator:aba52b6fe1b4fcb0e1128079ec6d203c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a995346d0f52c5cdc5f41ededf29d1d70" id="r_a995346d0f52c5cdc5f41ededf29d1d70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a995346d0f52c5cdc5f41ededf29d1d70">pressure_calib_dynam_ramp</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure)</td></tr>
<tr class="memdesc:a995346d0f52c5cdc5f41ededf29d1d70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that performs dynamic ramp calibration.  <br /></td></tr>
<tr class="separator:a995346d0f52c5cdc5f41ededf29d1d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa495417337ac1f7390a7d83ff19b26db" id="r_aa495417337ac1f7390a7d83ff19b26db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa495417337ac1f7390a7d83ff19b26db">pressure_calib_dynam_sine</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure)</td></tr>
<tr class="memdesc:aa495417337ac1f7390a7d83ff19b26db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that performs dynamic sine calibration.  <br /></td></tr>
<tr class="separator:aa495417337ac1f7390a7d83ff19b26db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cd91fd3a9608559c2a87a8ba6cba55f" id="r_a0cd91fd3a9608559c2a87a8ba6cba55f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cd91fd3a9608559c2a87a8ba6cba55f">HAL_GPIO_EXTI_Callback</a> (uint16_t GPIO_Pin)</td></tr>
<tr class="memdesc:a0cd91fd3a9608559c2a87a8ba6cba55f"><td class="mdescLeft">&#160;</td><td class="mdescRight">User interrupt callback.  <br /></td></tr>
<tr class="separator:a0cd91fd3a9608559c2a87a8ba6cba55f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a3b0ad512a6e6c6157440b68d395eac" id="r_a8a3b0ad512a6e6c6157440b68d395eac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a3b0ad512a6e6c6157440b68d395eac">HAL_TIM_PeriodElapsedCallback</a> (TIM_HandleTypeDef *htim)</td></tr>
<tr class="memdesc:a8a3b0ad512a6e6c6157440b68d395eac"><td class="mdescLeft">&#160;</td><td class="mdescRight">100ms timer callback  <br /></td></tr>
<tr class="separator:a8a3b0ad512a6e6c6157440b68d395eac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b877d5c0fd3288173e0f777427272a" id="r_a62b877d5c0fd3288173e0f777427272a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a62b877d5c0fd3288173e0f777427272a">pressure_main</a> (UART_HandleTypeDef *huart, ADC_HandleTypeDef *hadc, TIM_HandleTypeDef *htim_enc, _HandleTypeDef *htim_upd)</td></tr>
<tr class="memdesc:a62b877d5c0fd3288173e0f777427272a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structPressure.html">Pressure</a> system main.  <br /></td></tr>
<tr class="separator:a62b877d5c0fd3288173e0f777427272a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79ae16ffef5160d5f4e35b5b87a5b1eb" id="r_a79ae16ffef5160d5f4e35b5b87a5b1eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79ae16ffef5160d5f4e35b5b87a5b1eb">pressure_ramp_noconstrain</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure, uint8_t dev, float target)</td></tr>
<tr class="memdesc:a79ae16ffef5160d5f4e35b5b87a5b1eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ramps system to a target pressure using no error bounds.  <br /></td></tr>
<tr class="separator:a79ae16ffef5160d5f4e35b5b87a5b1eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5163aadfd9b997d622276b6506976a6" id="r_aa5163aadfd9b997d622276b6506976a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5163aadfd9b997d622276b6506976a6">pressure_ramp_v4</a> (struct <a class="el" href="structPressure.html">Pressure</a> *pressure, uint8_t dev, float target, float perr)</td></tr>
<tr class="memdesc:aa5163aadfd9b997d622276b6506976a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ramps system to a target pressure with error bounds.  <br /></td></tr>
<tr class="separator:aa5163aadfd9b997d622276b6506976a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa265bcd18bd7d7f6b30702053b178af6" id="r_aa265bcd18bd7d7f6b30702053b178af6"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa265bcd18bd7d7f6b30702053b178af6">userint_flg</a> = 0</td></tr>
<tr class="separator:aa265bcd18bd7d7f6b30702053b178af6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14681bfed2c3e68e34baf31c39b89362" id="r_a14681bfed2c3e68e34baf31c39b89362"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14681bfed2c3e68e34baf31c39b89362">userint_flg_lck</a> = 0</td></tr>
<tr class="separator:a14681bfed2c3e68e34baf31c39b89362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d37edeff2189eff8607e8696733f502" id="r_a4d37edeff2189eff8607e8696733f502"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d37edeff2189eff8607e8696733f502">tim3_flg</a> = 0</td></tr>
<tr class="separator:a4d37edeff2189eff8607e8696733f502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbbee1d1ecd3e9ffeaff753b85074137" id="r_adbbee1d1ecd3e9ffeaff753b85074137"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adbbee1d1ecd3e9ffeaff753b85074137">tim3_wraps</a> = 0</td></tr>
<tr class="separator:adbbee1d1ecd3e9ffeaff753b85074137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac89ba808e797db167743e1c74f8b59ba" id="r_ac89ba808e797db167743e1c74f8b59ba"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac89ba808e797db167743e1c74f8b59ba">tim3_elapsed</a> = 0.0f</td></tr>
<tr class="separator:ac89ba808e797db167743e1c74f8b59ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="structPressure.html">Pressure</a> system main program body. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0cd91fd3a9608559c2a87a8ba6cba55f" name="a0cd91fd3a9608559c2a87a8ba6cba55f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cd91fd3a9608559c2a87a8ba6cba55f">&#9670;&#160;</a></span>HAL_GPIO_EXTI_Callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HAL_GPIO_EXTI_Callback </td>
          <td>(</td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>GPIO_Pin</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User interrupt callback. </p>
<pre class="fragment">   Sets the user interrupt flags once the encoder is pressed.
</pre><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8a3b0ad512a6e6c6157440b68d395eac" name="a8a3b0ad512a6e6c6157440b68d395eac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a3b0ad512a6e6c6157440b68d395eac">&#9670;&#160;</a></span>HAL_TIM_PeriodElapsedCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HAL_TIM_PeriodElapsedCallback </td>
          <td>(</td>
          <td class="paramtype">TIM_HandleTypeDef *</td>          <td class="paramname"><span class="paramname"><em>htim</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>100ms timer callback </p>
<pre class="fragment">   Sets the 100ms timer flags and increments the total time elapsed
   by 100ms.
</pre><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a995346d0f52c5cdc5f41ededf29d1d70" name="a995346d0f52c5cdc5f41ededf29d1d70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a995346d0f52c5cdc5f41ededf29d1d70">&#9670;&#160;</a></span>pressure_calib_dynam_ramp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_calib_dynam_ramp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that performs dynamic ramp calibration. </p>
<pre class="fragment">   Generates a triangle wave using the specified parameters
   held by the .per, .ampl, .offset members in struct Pressure.

   To generate a cleaner ramp function, the sine function along with
   pressure_ramp_v4 are used instead of an actual ramp function with
   pressure_ramp_v3. The previous method still works, except it would
   take some work playing with parameters to generate a proper
   triangle wave. The previous method has been left commented in the
   code below.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug</a></b></dt><dd>Given the nature of pressure_ramp_v4, this function essentially ignores the .per member, effectively making the period parameter useless.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa495417337ac1f7390a7d83ff19b26db" name="aa495417337ac1f7390a7d83ff19b26db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa495417337ac1f7390a7d83ff19b26db">&#9670;&#160;</a></span>pressure_calib_dynam_sine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_calib_dynam_sine </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that performs dynamic sine calibration. </p>
<pre class="fragment">   Generates a sine wave using the specified parameters
   held by the .per, .ampl, .offset members in struct
   Pressure.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aba52b6fe1b4fcb0e1128079ec6d203c6" name="aba52b6fe1b4fcb0e1128079ec6d203c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba52b6fe1b4fcb0e1128079ec6d203c6">&#9670;&#160;</a></span>pressure_calib_dynam_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_calib_dynam_step </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that performs dynamic step calibration. </p>
<pre class="fragment">   Forms a square wave by continuously ramping to the value in .ampl
   from .offset, and waiting for a duration specified by .per found
   under struct Pressure.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3de0ebd076031525e341166e7845a37a" name="a3de0ebd076031525e341166e7845a37a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3de0ebd076031525e341166e7845a37a">&#9670;&#160;</a></span>pressure_calib_static()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_calib_static </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that performs static calibration. </p>
<pre class="fragment">   Ramps to the specified offset under the .offset member of
   struct Pressure. Maintains pressure until user interrupt flag
   is set.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af557db21f677bfcc5c63fa8689be6db9" name="af557db21f677bfcc5c63fa8689be6db9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af557db21f677bfcc5c63fa8689be6db9">&#9670;&#160;</a></span>pressure_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_cleanup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deinitializes components for the pressure system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adda669c0c808f211208dfa3d3551c094" name="adda669c0c808f211208dfa3d3551c094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda669c0c808f211208dfa3d3551c094">&#9670;&#160;</a></span>pressure_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes components for the pressure system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a62b877d5c0fd3288173e0f777427272a" name="a62b877d5c0fd3288173e0f777427272a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62b877d5c0fd3288173e0f777427272a">&#9670;&#160;</a></span>pressure_main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_main </td>
          <td>(</td>
          <td class="paramtype">UART_HandleTypeDef *</td>          <td class="paramname"><span class="paramname"><em>huart</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ADC_HandleTypeDef *</td>          <td class="paramname"><span class="paramname"><em>hadc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TIM_HandleTypeDef *</td>          <td class="paramname"><span class="paramname"><em>htim_enc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_HandleTypeDef *</td>          <td class="paramname"><span class="paramname"><em>htim_upd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structPressure.html">Pressure</a> system main. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">huart</td><td>Pointer to a HAL UART handle for data plotting </td></tr>
    <tr><td class="paramname">hadc</td><td>Pointer to a HAL ADC handle for incoming reference sensor data </td></tr>
    <tr><td class="paramname">htim_enc</td><td>Pointer to a HAL timer handle for rotary encoder </td></tr>
    <tr><td class="paramname">htim_upd</td><td>Pointer to a HAL timer handle set for 100ms</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a79ae16ffef5160d5f4e35b5b87a5b1eb" name="a79ae16ffef5160d5f4e35b5b87a5b1eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79ae16ffef5160d5f4e35b5b87a5b1eb">&#9670;&#160;</a></span>pressure_ramp_noconstrain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_ramp_noconstrain </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>target</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ramps system to a target pressure using no error bounds. </p>
<pre class="fragment">   Mainly used to ramp to initial offsets
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct </td></tr>
    <tr><td class="paramname">dev</td><td>The device to turn on to generate the ramp 1 : Compressor 2 : Exhaust valve </td></tr>
    <tr><td class="paramname">target</td><td>Target pressure to ramp to</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aec131e0e34a56c67505246c8124dfe3c" name="aec131e0e34a56c67505246c8124dfe3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec131e0e34a56c67505246c8124dfe3c">&#9670;&#160;</a></span>pressure_ramp_v3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_ramp_v3 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>perr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ramps system to a target pressure with error bounds. </p>
<pre class="fragment">   Turns off the compressor or valve when either the target pressure is
   met or 500ms has passed.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct </td></tr>
    <tr><td class="paramname">dev</td><td>The device to turn on to generate the ramp. 1 : Compressor 2 : Exhaust valve default: wait for 500ms </td></tr>
    <tr><td class="paramname">target</td><td>Target pressure to ramp to </td></tr>
    <tr><td class="paramname">perr</td><td>The amount of allowable error for the target. Values should be between 0.0 and 1.0.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa5163aadfd9b997d622276b6506976a6" name="aa5163aadfd9b997d622276b6506976a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5163aadfd9b997d622276b6506976a6">&#9670;&#160;</a></span>pressure_ramp_v4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_ramp_v4 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>perr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ramps system to a target pressure with error bounds. </p>
<pre class="fragment">   Essentially the same function as pressure_ramp_v3, except this
   function turns off the device once the system pressurizes to the specified
   target; there's no waiting for any duration between points.

   Ultimately, this function was used by pressure_calib_dynam_ramp to
   generate a clean triangle wave.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct </td></tr>
    <tr><td class="paramname">dev</td><td>The device to turn on to generate the ramp 1 : Compressor 2 : Exhaust valve </td></tr>
    <tr><td class="paramname">target</td><td>Target pressure to ramp to </td></tr>
    <tr><td class="paramname">perr</td><td>The amount of allowable error for the target. Values should be between 0.0 and 1.0.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a47565a90a90de1e680ec70255cc7bfd0" name="a47565a90a90de1e680ec70255cc7bfd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47565a90a90de1e680ec70255cc7bfd0">&#9670;&#160;</a></span>pressure_sensor_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_sensor_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads in the current pressure from the sensor using the ADC. </p>
<pre class="fragment">   Displays sensor data to LCD and transmits through UART to PC.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a945eb3fcaf46267415c8d3452eb5904f" name="a945eb3fcaf46267415c8d3452eb5904f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a945eb3fcaf46267415c8d3452eb5904f">&#9670;&#160;</a></span>pressure_uart_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pressure_uart_tx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPressure.html">Pressure</a> *</td>          <td class="paramname"><span class="paramname"><em>pressure</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmits the current pressure read by the sensor out through UART. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pressure</td><td>A pointer to a pressure struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ac89ba808e797db167743e1c74f8b59ba" name="ac89ba808e797db167743e1c74f8b59ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac89ba808e797db167743e1c74f8b59ba">&#9670;&#160;</a></span>tim3_elapsed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float tim3_elapsed = 0.0f</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Amount of time elapsed during test </p>

</div>
</div>
<a id="a4d37edeff2189eff8607e8696733f502" name="a4d37edeff2189eff8607e8696733f502"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d37edeff2189eff8607e8696733f502">&#9670;&#160;</a></span>tim3_flg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t tim3_flg = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag that indicates 100ms </p>

</div>
</div>
<a id="adbbee1d1ecd3e9ffeaff753b85074137" name="adbbee1d1ecd3e9ffeaff753b85074137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbbee1d1ecd3e9ffeaff753b85074137">&#9670;&#160;</a></span>tim3_wraps</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t tim3_wraps = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of 100ms intervals </p>

</div>
</div>
<a id="aa265bcd18bd7d7f6b30702053b178af6" name="aa265bcd18bd7d7f6b30702053b178af6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa265bcd18bd7d7f6b30702053b178af6">&#9670;&#160;</a></span>userint_flg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t userint_flg = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>User interrupt flag </p>

</div>
</div>
<a id="a14681bfed2c3e68e34baf31c39b89362" name="a14681bfed2c3e68e34baf31c39b89362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14681bfed2c3e68e34baf31c39b89362">&#9670;&#160;</a></span>userint_flg_lck</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t userint_flg_lck = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>User interrupt lock var </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
